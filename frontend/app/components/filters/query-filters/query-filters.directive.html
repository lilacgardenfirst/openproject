<fieldset id="filters" class="advanced-filters--container">
  <legend ng-bind="I18n.t('js.label_selected_filter_list')"></legend>

  <ul class="advanced-filters--filters">
    <li query-filter
        ng-repeat="filter in query.filters"
        ng-if="initialized"
        id="filter_{{filter.name}}"
        class="advanced-filters--filter">

      <!-- Hidden for form -->
      <input id="h_{{ filter.name }}" name="f[]" type="hidden" value="{{ filter.name }}" ng-disabled="filter.deactivated"/>

      <!-- Name -->
      <label for="operators-{{filter.name}}"
             class="advanced-filters--filter-name"
             title="{{ localisedFilterName(query.availableWorkPackageFilters[filter.name]) }}">
        {{ ::filter.name }}
      </label>

      <div class="advanced-filters--operator-value-container">

      <!-- Operator -->
      <div class="advanced-filters--filter-operator">

         <label for="operators-{{filter.name}}" class="hidden-for-sighted">
          {{ ::filter.name }}
          {{ ::I18n.t('js.filter.description.text_open_filter') }}
        </label>

        <select require
                focus="{{$index == focusElementIndex}}"
                class="advanced-filters--select"
                id="operators-{{filter.name}}"
                name="op[{{filter.name}}]"
                ng-model="filter.operator"
                style="vertical-align: top;"
                ng-disabled="isLoading"
                ng-options="operator.name for operator in availableOperators track by operator.href">
        </select>
      </div>

      <!-- Values -->
      <div class="advanced-filters--filter-value"
           ng-show="showValuesInput">

        <div id="div-values-{{filter.name}}"
             ng-if="!showValueOptionsAsSelect"
             ng-switch="filter.currentSchema.values.type">


          <filter-integer-value ng-switch-when="[1]Integer"
                                filter="filter" >
          <label ng-switch-when="[1]Integer" for="values-{{filter.name}}" class="hidden-for-sighted">
            {{ I18n.t('js.work_packages.description_enter_text') }}
          </label>


          <div ng-switch-when="[1]Date">
            <op-date-picker>
              <input ng-model="filter.values[0]"
                   ng-model-options="::filterDateModelOptions"
                   ng-required="true"
                   ng-disabled="isLoading"
                   id="values-{{filter.name}}"
                   name="v[{{filter.name}}]"
                   class="advanced-filters--date-field"
                   size="10"
                   transform-date-value
                   type="text"/>
            </op-date-picker>
          </div>
          <label ng-switch-when="[1]Date" for="values-{{filter.name}}" class="form-label -transparent">
            {{ I18n.t('js.work_packages.time_relative.days') }}
          </label>


          <div ng-switch-when="[2]Date">
            <op-date-picker>
              <input ng-model="filter.values[0]"
                   ng-model-options="::filterDateModelOptions"
                   ng-required="true"
                   ng-disabled="isLoading"
                   id="values-{{filter.name}}-begin"
                   name="v[{{filter.name}}]-begin"
                   class="advanced-filters--date-field"
                   size="10"
                   transform-date-value
                   type="text"/>
            </op-date-picker>
          </div>

          <div ng-switch-when="[2]Date">
            <op-date-picker>
              <input ng-model="filter.values[1]"
                   ng-model-options="::filterDateModelOptions"
                   ng-required="true"
                   ng-disabled="isLoading"
                   id="values-{{filter.name}}-end"
                   name="v[{{filter.name}}]-end"
                   class="advanced-filters--date-field"
                   size="10"
                   transform-date-value
                   type="text"/>
            </op-date-picker>
          </div>

          <label ng-switch-when="[2]Date" for="values-{{filter.name}}-end" class="form-label -transparent">
            {{ I18n.t('js.work_packages.time_relative.days') }}
          </label>



          <input ng-switch-when="[1]String"
                 ng-model="filter.values[0]"
                 ng-model-options="::filterModelOptions"
                 ng-required="true"
                 class="advanced-filters--text-field"
                 id="values-{{filter.name}}"
                 name="v[{{filter.name}}]"
                 size="30"
                 type="text"
                 value=""
                 ng-disabled="isLoading"/>
          <label ng-switch-when="string"
                 for="values-{{filter.name}}"
                 class="hidden-for-sighted">
            {{ I18n.t('js.work_packages.description_enter_text') }}
          </label>

        </div>

        <div ng-if="showValueOptionsAsSelect">
          <toggled-multiselect available-options="availableFilterValueOptions"
                               filter="filter"
                               is-multiselect="false"
                               isDisabled="isLoading"/>
        </div>
      </div>

      <div class="advanced-filters--remove-filter">
        <accessible-by-keyboard execute="deactivateFilter(filter)">
          <icon-wrapper icon-name="close"
                        icon-title="{{I18n.t('js.button_delete')}}"
                        css-class="advanced-filters--remove-filter-icon"/>
        </accessible-by-keyboard>
      </div>

    </li>

    <li class="advanced-filters--spacer" ng-if="query.getActiveFilters().length > 0"></li>

    <li class="advanced-filters--add-filter">
      <!-- Add filters -->
      <label for="add_filter_select" aria-hidden="true" class="advanced-filters--add-filter-label">
        <i class="icon-add icon4"></i>
        {{ I18n.t('js.work_packages.label_filter_add') }}:
      </label>
      <label for="add_filter_select" class="hidden-for-sighted">
        {{ I18n.t('js.work_packages.label_filter_add') }}
        {{ I18n.t('js.filter.description.text_open_filter') }}
        {{ I18n.t('js.filter.description.text_close_filter') }}
      </label>

      <div class="advanced-filters--add-filter-value">
        <select class="advanced-filters--select"
          id="add_filter_select"
          focus="{{focusElementIndex == -1}}"
          ng-model="filterToBeAdded"
          ng-options="filter.name for filter in remainingFilters | orderBy: 'name'" />
        </select>
      </div>
    </li>
  </ul>

  <input id="f_" name="f[]" type="hidden" value=""/>
</fieldset>
